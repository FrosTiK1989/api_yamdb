# Проект YaMDb

**Проект YaMDb собирает:**

- отзывы ***Review*** пользователей на произведения
- ***Titles*** Произведения делятся на категории:
  - "Книги"
  - "Фильмы"
  - "Музыка"
- Список категорий **"Category"** может быть расширен администратором (например, можно добавить категорию «Изобразительное искусство» или «Ювелирка»).

Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.

=
В каждой категории есть произведения: книги, фильмы или музыка. Например

- в категории «Книги» могут быть произведения «Винни-Пух и все-все-все» и «Марсианские хроники»
- в категории «Музыка» — песня «Давеча» группы «Насекомые» и вторая сюита Баха.

Произведению может быть присвоен жанр ***Genre*** из списка предустановленных:
> например, «Сказка», «Рок» или «Артхаус».

## Новые жанры может создавать только администратор

Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы **Review** и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.

### Как запустить проект

Приступая к работе

Страница проекта на github: <https://github.com/frostik1989/api_yamdb> Доступны следующие способы получения проекта:

С помощью системы управления версиями Git:

- HTTPS - <https://github.com/FrosTiK1989/api_yamdb.git>
- SSH - git@github.com:FrosTiK1989/api_yamdb.git
- CLI - gh repo clone FrosTiK1989/api_yamdb
- Скачать архивом: <https://github.com/FrosTiK1989/api_yamdb/archive/refs/heads/master.zip>

Убедитесь что у вас установлен python 3.9. Данный проект разработан и протестирован для данной версии python. [Как установить?](https://www.python.org/downloads/release/python-390/ "Сайт Python")

Запуск проекта

Я предпологаю что вы используете актуальные версии операционной системы. Выполните команду python --version Если она вернет результат Python 3.. то используйте команды как они указаны ниже. Если команда вернет Python 2.. то во всех командах замените python на python3. В папке с копией проекта создайте виртуальное окружение командой: `python -m venv venv`

- Активируйте виртуальное окружение командой:
- для windows powershell: `./venv/scripts/activate`
- для linux bash: source `venv/bin/activate`
- Установите необходимые зависимости командой: `pip install -r requirements.txt`
- Создайте и примините миграции командой: `python manage.py makemigrations ; python manage.py migrate`
- Запустите проект командой: `python manage.py runserver`

**К проекту по [ссылке](http://127.0.0.1:8000/redoc/ "Инструкия по развертванию проекта находится ниже") подключена документация**

В ней описаны возможные запросы к API и структура ожидаемых ответов. Для каждого запроса указаны уровни прав доступа: пользовательские роли, которым разрешён запрос

## Пользовательские роли

- Аноним — может просматривать описания произведений, читать отзывы и комментарии.
- Аутентифицированный пользователь (user) — может читать всё, как и Аноним, может публиковать отзывы и ставить оценки произведениям (фильмам/книгам/песенкам), может комментировать отзывы; может редактировать и удалять свои отзывы и комментарии, редактировать свои оценки произведений. Эта роль присваивается по умолчанию каждому новому пользователю.
- Модератор (moderator) — те же права, что и у Аутентифицированного пользователя, плюс право удалять и редактировать любые отзывы и комментарии.
- Администратор (admin) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
- Суперюзер Django должен всегда обладать правами администратора, пользователя с правами admin. Даже если изменить пользовательскую роль суперюзера — это не лишит его прав администратора. Суперюзер — всегда администратор, но администратор — не обязательно суперюзер.

## Самостоятельная регистрация новых пользователей

1. Пользователь отправляет POST-запрос с параметрами email и username на эндпоинт

> Получить код подтверждения на переданный email.

> Права доступа: Доступно без токена.

> Использовать имя 'me' в качестве username запрещено.

> Поля email и username должны быть уникальными.

``
http://127.0.0.1:8000/api/v1/auth/signup/
``
> Пример ожидаемого заполнения:

``` json
{
  "email": "string",
  "username": "string"
}
```

2.Сервис YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на указанный адрес email.
3. Пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт

``
http://127.0.0.1:8000/api/v1/auth/token/
``
> Пример ожидаемого заполнения:

``` json
{
  "username": "string",
  "confirmation_code": "string"
}
```

> Удачный запрос вернется в виде:

``` json
{
  "token": "string"
}
```

> в ответе на запрос ему приходит token (JWT-токен).

В результате пользователь получает токен и может работать с API проекта, отправляя этот токен с каждым запросом.
После регистрации и получения токена пользователь может отправить PATCH-запрос на эндпоинт

``
http://127.0.0.1:8000/api/v1/users/me/
``
> Пример ожидаемого заполнения:

``` json
{
  "username": "string",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string"
}
```

и заполнить поля в своём профайле (описание полей — в [документации](http://127.0.0.1:8000/redoc/)).

## Создание пользователя администратором

- Пользователя может создать администратор — через админ-зону сайта или через POST-запрос на специальный эндпоинт

``
http://127.0.0.1:8000/api/v1/users/
``
> Пример ожидаемого заполнения:

``` json
{
  "username": "string",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string",
  "role": "user"
}
```

(описание полей запроса для этого случая — в [документации](http://127.0.0.1:8000/redoc/)).
В этот момент письмо с кодом подтверждения пользователю отправлять не нужно.

- После этого пользователь должен самостоятельно отправить свой *email* и *username* на эндпоинт

``
http://127.0.0.1:8000/api/v1/auth/signup/
``
> Пример ожидаемого заполнения:

``` json
{
  "email": "string",
  "username": "string"
}
```

в ответ ему должно прийти письмо с кодом подтверждения.

> Пример ответа при неверном заполнении:

``` json
{
  "field_name": [
    "string"
  ]
}
```

- Далее пользователь отправляет POST-запрос с параметрами *username* и *confirmation_code* на эндпоинт

``
http://127.0.0.1:8000/api/v1/auth/token/
``
> Пример ожидаемого заполнения:

``` json
{
  "username": "string",
  "confirmation_code": "string"
}
```

в ответе на запрос ему приходит token (JWT-токен), как и при самостоятельной регистрации.
